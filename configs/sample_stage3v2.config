# =============================================================================
# Stage 3 V2 Sampling Configuration - Ultra-Long Generation
# =============================================================================
# Stage: 1 + 2 + 3 + V2
# Max Length: L=4096-6144
# Memory: ~18GB for L=4096
# Use Case: Ultra-long protein or multi-domain generation
# =============================================================================

# Basic Sampling Settings
name stage3v2_ultralong_sampling
seed 42
targetLength 128
numSamples 20
batchSize 1

# Model Checkpoint
checkpointPath weights/stage3v2_model.ckpt

# Sampling Strategy
samplingStrategy ddim
numDiffusionSteps 1000
skipSteps 200                  # Skip to 800 steps for ultra-long

# Noise Schedule
noiseSchedule cosine
startBeta 1e-5
endBeta 0.02

# Temperature & Guidance
temperature 0.9                # Lower for long sequences
guidanceScale 1.0

# *** STAGE 1-3 FEATURES ***
useFactorizedPairs True
zFactorRank 2
pairFactorDim 64

useFactorizedTriangleOps True
triangleUpdateRank 4

useMixedPrecision True
precision 16

# *** STAGE 3 V2 FEATURE ***
useSparseKNN True
kNeighbors 32
knnStrategy hybrid             # Hybrid: coordinate + sequence
useSpatialBias True
spatialBiasRange 16

# Output Settings
outputDir samples/stage3v2
savePDB False
saveTrajectory False           # Memory intensive for L=4096
saveMetrics True
saveFragments True             # Save domain fragments separately
fragmentSize 512               # Split into 512-residue fragments

# Hardware Settings
device cuda:0

# Stage Features
useAxialAttention False
