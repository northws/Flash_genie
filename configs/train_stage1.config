# =============================================================================
# Stage 1 Configuration - Factorized Pair Features
# =============================================================================
# Stage: 1
# Max Length: L=512-768
# Memory: ~12GB for L=512
# Memory Saving: 500x (pair features)
# Use Case: First step to long sequences
# =============================================================================

# Basic Training Settings
name stage1_factorized_training
seed 42
batchSize 4
gradientAccumulation 1
maximumNumResidues 512

# Model Architecture - Factorized Pairs
singleFeatureDimension 256
pairFeatureDimension 128
structureEncoderDepth 3
structureEncoderHeads 4

# *** STAGE 1 KEY FEATURE: Factorized Pair Representation ***
useFactorizedPairs True
zFactorRank 2              # Low-rank factorization (z_i, z_j) -> pair features
pairFactorDim 64           # Dimension of factor vectors

# Learning Rate & Optimization
learningRate 1e-4
warmupEpochs 50
numEpochs 500
gradientClipVal 1.0
weightDecay 0.01

# Loss Settings
lossWeights {
    "translation": 1.0,
    "rotation": 1.0,
    "backbone": 1.0,
    "chi": 0.5
}

# Diffusion Settings
diffusionTimesteps 1000
diffusionSchedule cosine
noiseSchedule exponential

# Hardware Settings
numWorkers 4
precision 32
accelerator gpu
devices 1

# Monitoring
logEveryNSteps 50
saveEveryNEpochs 10
validateEveryNEpochs 5

# Stage Features
useProgressiveTraining False
useMixedPrecision False
useChunkedLoss False
useSparseKNN False
useAxialAttention False
useModelCompression False
useDistributed False
